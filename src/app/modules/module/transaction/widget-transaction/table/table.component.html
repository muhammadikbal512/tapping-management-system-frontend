<button mat-raised-button color="primary"
  (click)="exporter.exportTable('xlsx', {fileName:'Transaction Excel', sheet: 'Transaction', Props: {Author: 'TMS'}})">Export
  data as XLS</button>

<div class="table-container mt-4">
  <table matTableExporter #exporter="matTableExporter" mat-table [dataSource]="dataSource" multiTemplateDataRows
    class="mat-elevation-z8">
    <ng-container matColumnDef="action">
      <th mat-header-cell *matHeaderCellDef> Actions </th>
      <td mat-cell *matCellDef="let element">
        <mat-icon (click)="expandedElement = expandedElement === element ? null : element">{{expandedElement ===
          element ? 'expand_less' : 'expand_more'}}</mat-icon>
      </td>
    </ng-container>
    <ng-container matColumnDef="amount">
      <th class="header" mat-header-cell *matHeaderCellDef>
        Amount
        <mat-form-field class="filter" floatLabel="never">
          <mat-label>Search</mat-label>
          <input matInput [formControl]="amount">
        </mat-form-field>
      </th>
      <td mat-cell *matCellDef="let element">{{element.amount}}</td>
    </ng-container>
    <ng-container matColumnDef="countryCode">
      <th class="header" mat-header-cell *matHeaderCellDef>
        countryCode
        <mat-form-field class="filter" floatLabel="never">
          <mat-label>Search</mat-label>
          <input matInput [formControl]="countryCode">
        </mat-form-field>
      </th>
      <td mat-cell *matCellDef="let element">{{element.countryCode}}</td>
    </ng-container>
    <ng-container matColumnDef="destAccount">
      <th class="header" mat-header-cell *matHeaderCellDef>
        destAccount
        <mat-form-field class="filter" floatLabel="never">
          <mat-label>Search</mat-label>
          <input matInput [formControl]="destAccount">
        </mat-form-field>
      </th>
      <td mat-cell *matCellDef="let element">{{element.destAccount}}</td>
    </ng-container>
    <ng-container matColumnDef="HPAN">
      <th class="header" mat-header-cell *matHeaderCellDef>
        HPAN
        <mat-form-field class="filter" floatLabel="never">
          <mat-label>Search</mat-label>
          <input matInput [formControl]="hpan">
        </mat-form-field>
      </th>
      <td mat-cell *matCellDef="let element">{{element.hpan}}</td>
    </ng-container>

    <ng-container matColumnDef="merchantId">
      <th class="header" mat-header-cell *matHeaderCellDef>
        merchantId
        <mat-form-field class="filter" floatLabel="never">
          <mat-label>Search</mat-label>
          <input matInput [formControl]="merchantId">
        </mat-form-field>
      </th>
      <td mat-cell *matCellDef="let element">{{element.merchantId}}</td>
    </ng-container>
    <ng-container matColumnDef="merchantType">
      <th class="header" mat-header-cell *matHeaderCellDef>
        merchantType
        <mat-form-field class="filter" floatLabel="never">
          <mat-label>Search</mat-label>
          <input matInput [formControl]="merchantType">
        </mat-form-field>
      </th>
      <td mat-cell *matCellDef="let element">{{element.merchantType}}</td>
    </ng-container>
    <ng-container matColumnDef="messageAscii">
      <th class="header" mat-header-cell *matHeaderCellDef>
        Message Ascii
        <mat-form-field class="filter" floatLabel="never">
          <mat-label>Search</mat-label>
          <input matInput [formControl]="messageAscii">
        </mat-form-field>
      </th>
      <td mat-cell *matCellDef="let element">{{element.messageAscii}}</td>
    </ng-container>
    <ng-container matColumnDef="messageHexa">
      <th class="header" mat-header-cell *matHeaderCellDef>
        Message Hexa
        <mat-form-field class="filter" floatLabel="never">
          <mat-label>Search</mat-label>
          <input matInput [formControl]="messageHexa">
        </mat-form-field>
      </th>
      <td mat-cell *matCellDef="let element">{{element.messageHexa}}</td>
    </ng-container>
    <ng-container matColumnDef="MTI">
      <th class="header" mat-header-cell *matHeaderCellDef>
        MTI
        <mat-form-field class="filter" floatLabel="never">
          <mat-label>Search</mat-label>
          <input matInput [formControl]="mti">
        </mat-form-field>
      </th>
      <td mat-cell *matCellDef="let element">{{element.mti}}</td>
    </ng-container>
    <ng-container matColumnDef="networkId">
      <th class="header" mat-header-cell *matHeaderCellDef>
        networkId
        <mat-form-field class="filter" floatLabel="never">
          <mat-label>Search</mat-label>
          <input matInput [formControl]="networkId">
        </mat-form-field>
      </th>
      <td mat-cell *matCellDef="let element">{{element.networkId}}</td>
    </ng-container>
    <ng-container matColumnDef="posDataCode">
      <th class="header" mat-header-cell *matHeaderCellDef>
        Post Data Code
        <mat-form-field class="filter" floatLabel="never">
          <mat-label>Search</mat-label>
          <input matInput [formControl]="posDataCode">
        </mat-form-field>
      </th>
      <td mat-cell *matCellDef="let element">{{element.posDataCode}}</td>
    </ng-container>
    <ng-container matColumnDef="responseCode">
      <th class="header" mat-header-cell *matHeaderCellDef>
        responseCode
        <mat-form-field class="filter" floatLabel="never">
          <mat-label>Search</mat-label>
          <input matInput [formControl]="responseCode">
        </mat-form-field>
      </th>
      <td mat-cell *matCellDef="let element">{{element.responseCode}}</td>
    </ng-container>
    <ng-container matColumnDef="rrn">
      <th class="header" mat-header-cell *matHeaderCellDef>
        rrn
        <mat-form-field class="filter" floatLabel="never">
          <mat-label>Search</mat-label>
          <input matInput [formControl]="rrn">
        </mat-form-field>
      </th>
      <td mat-cell *matCellDef="let element">{{element.rrn}}</td>
    </ng-container>
    <ng-container matColumnDef="sourceAccount">
      <th class="header" mat-header-cell *matHeaderCellDef>
        srcAccount
        <mat-form-field class="filter" floatLabel="never">
          <mat-label>Search</mat-label>
          <input matInput [formControl]="sourceAccount">
        </mat-form-field>
      </th>
      <td mat-cell *matCellDef="let element">{{element.sourceAccount}}</td>
    </ng-container>
    <ng-container matColumnDef="terminalId">
      <th class="header" mat-header-cell *matHeaderCellDef>
        terminalId
        <mat-form-field class="filter" floatLabel="never">
          <mat-label>Search</mat-label>
          <input matInput [formControl]="terminalId">
        </mat-form-field>
      </th>
      <td mat-cell *matCellDef="let element">{{element.terminalId}}</td>
    </ng-container>
    <ng-container matColumnDef="trxDate">
      <th class="header" mat-header-cell *matHeaderCellDef>
        transactionDate
        <mat-form-field class="filter" floatLabel="never">
          <mat-label>Search</mat-label>
          <input matInput [formControl]="trxDate">
        </mat-form-field>
      </th>
      <td mat-cell *matCellDef="let element">{{element.trxDate}}</td>
    </ng-container>
    <ng-container matColumnDef="transactionId">
      <th class="header" mat-header-cell *matHeaderCellDef>
        transactionId
        <mat-form-field class="filter" floatLabel="never">
          <mat-label>Search</mat-label>
          <input matInput [formControl]="transactionId">
        </mat-form-field>
      </th>
      <td mat-cell *matCellDef="let element">{{element.transactionId}}</td>
    </ng-container>
    <ng-container matColumnDef="transType">
      <th class="header" mat-header-cell *matHeaderCellDef>
        transType
        <mat-form-field class="filter" floatLabel="never">
          <mat-label>Search</mat-label>
          <input matInput [formControl]="transType">
        </mat-form-field>
      </th>
      <td mat-cell *matCellDef="let element">{{element.transType}}</td>
    </ng-container>
    <!-- <ng-container matColumnDef="{{column}}" *ngFor="let column of columnsToDisplay; let i=index">
      <ng-container *ngIf="column !== 'action'; else action">
        <th mat-header-cell *matHeaderCellDef> {{column}} 
          <mat-form-field class="filter" floatLabel="never">
            <mat-label>Search</mat-label>
            <input matInput [formControl]="amount" placeholder=" " />
          </mat-form-field>
        </th>
        <td mat-cell *matCellDef="let element"> {{element[column]}} </td>
      </ng-container>
      <ng-template #action>
        <th mat-header-cell *matHeaderCellDef> Actions </th>
        <td mat-cell *matCellDef="let element">
          <mat-icon (click)="expandedElement = expandedElement === element ? null : element">{{expandedElement ===
            element ? 'expand_less' : 'expand_more'}}</mat-icon>
        </td>
      </ng-template>
    </ng-container> -->


    <ng-container matColumnDef="expandedDetail">
      <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplay.length">
        <div class="example-element-detail" [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
          <table class="bg-gray-300 rounded-lg" style="border: 1px solid black;">
            <p>Client</p>
            <tr style="text-align:center; border: 1px solid black;">
              <td>{{date | date: 'HH:mm:ss'}}</td>
              <td>000.0 sec</td>
              <td>000.0 sec</td>
              <td><i class="pi pi-arrow-right"></i></td>
              <td>TCP Connect Request - SYN</td>
            </tr>
            <tr style="text-align:center; border: 1px solid black;">
              <td>{{date | date: 'HH:mm:ss'}}</td>
              <td>000.0 sec</td>
              <td>000.0 sec</td>
              <td><i class="pi pi-arrow-left"></i></td>
              <td>TCP Connect Response - SYN ACK</td>
            </tr>
            <tr style="text-align:center; border: 1px solid black;">
              <td>{{date | date: 'HH:mm:ss'}}</td>
              <td>000.0 sec</td>
              <td>000.0 sec</td>
              <td><i class="pi pi-arrow-right"></i></td>
              <td>TCP ACK</td>
            </tr>
            <tr style="text-align:center; border: 1px solid black;">
              <td>{{date | date: 'HH:mm:ss'}}</td>
              <td>000.0 sec</td>
              <td>000.0 sec</td>
              <td><i class="pi pi-arrow-right"></i></td>
              <td>Triton Transaction Request</td>
            </tr>
            <tr style="text-align:center; border: 1px solid black;">
              <td>{{date | date: 'HH:mm:ss'}}</td>
              <td>000.0 sec</td>
              <td>000.0 sec</td>
              <td><i class="pi pi-arrow-left"></i></td>
              <td>TCP ACK</td>
            </tr>
            <tr style="text-align:center; border: 1px solid black;">
              <td>{{date | date: 'HH:mm:ss'}}</td>
              <td>000.0 sec</td>
              <td>000.0 sec</td>
              <td><i class="pi pi-arrow-right"></i></td>
              <td>TCP ACK - Piggyback</td>
            </tr>
            <tr class="text-center bg-red-300" style="border: 1px solid black;">
              <td>{{date | date: 'HH:mm:ss'}}</td>
              <td>000.0 sec</td>
              <td>000.0 sec</td>
              <td><i class="pi pi-arrow-right"></i></td>
              <td>TCP Disconnect - FIN</td>
            </tr>
            <tr style="text-align:center; border: 1px solid black;">
              <td>{{date | date: 'HH:mm:ss'}}</td>
              <td>000.0 sec</td>
              <td>000.0 sec</td>
              <td><i class="pi pi-arrow-left"></i></td>
              <td>TCP ACK</td>
            </tr>
            <tr class="text-center bg-red-300" style="border: 1px solid black;">
              <td>{{date | date: 'HH:mm:ss'}}</td>
              <td>000.0 sec</td>
              <td>000.0 sec</td>
              <td><i class="pi pi-arrow-left"></i></td>
              <td>TCP Disconnect - FIN</td>
            </tr>
            <tr style="text-align:center; border: 1px solid black;">
              <td>{{date | date: 'HH:mm:ss'}}</td>
              <td>000.0 sec</td>
              <td>000.0 sec</td>
              <td><i class="pi pi-arrow-right"></i></td>
              <td>TCP ACK</td>
            </tr>

            <p class="mt-3">Backend</p>
            <tr style="text-align:center; border: 1px solid black;">
              <td>{{date | date: 'HH:mm:ss'}}</td>
              <td>000.0 sec</td>
              <td>000.0 sec</td>
              <td><i class="pi pi-arrow-right"></i></td>
              <td>Triton Transaction Request</td>
            </tr>
            <tr style="text-align:center; border: 1px solid black;">
              <td>{{date | date: 'HH:mm:ss'}}</td>
              <td>000.0 sec</td>
              <td>000.0 sec</td>
              <td><i class="pi pi-arrow-left"></i></td>
              <td>TCP ACK</td>
            </tr>
            <tr style="text-align:center; border: 1px solid black;">
              <td>{{date | date: 'HH:mm:ss'}}</td>
              <td>000.0 sec</td>
              <td>000.0 sec</td>
              <td><i class="pi pi-arrow-left"></i></td>
              <td>Triton Transaction Response - SYN</td>
            </tr>
            <tr style="text-align:center; border: 1px solid black;">
              <td>{{date | date: 'HH:mm:ss'}}</td>
              <td>000.0 sec</td>
              <td>000.0 sec</td>
              <td><i class="pi pi-arrow-right"></i></td>
              <td>TCP ACK - Piggyback</td>
            </tr>
          </table>
        </div>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="columnsToDisplay; sticky:true;"></tr>
    <tr mat-row *matRowDef="let element; columns: columnsToDisplay;" class="example-element-row"
      [class.example-expanded-row]="expandedElement === element"
      (click)="expandedElement = expandedElement === element ? null : element">
    </tr>
    <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>
  </table>

  <div *ngIf="isLoading" style="display: flex; justify-content: center; align-items: center; background: white;">
    <mat-progress-spinner color="primary" mode="indeterminate">
    </mat-progress-spinner>
  </div>

</div>

<mat-paginator #paginator [length]="totalRows" [pageIndex]="currentPage" [pageSize]="pageSize"
  [pageSizeOptions]="pageSizeOptions" showFirstLastButtons aria-label="Select page">
</mat-paginator>